# âœ… ç¡®ä¿éƒ¨ç½²æˆåŠŸ - å®Œæ•´æ­¥éª¤

## ğŸ“‹ æœåŠ¡å™¨ä¿¡æ¯
- IP: 182.92.59.70
- ç”¨æˆ·: root
- å¯†ç : ryg@893012

---

## ğŸš€ ç¬¬ä¸€æ­¥ï¼šè¿æ¥æœåŠ¡å™¨

```bash
ssh root@182.92.59.70
# è¾“å…¥å¯†ç : ryg@893012
```

---

## ğŸ”§ ç¬¬äºŒæ­¥ï¼šåœ¨æœåŠ¡å™¨ä¸Šé…ç½®ç¯å¢ƒï¼ˆå¤åˆ¶å…¨éƒ¨æ‰§è¡Œï¼‰

```bash
# å®‰è£…Node.js
curl -fsSL https://rpm.nodesource.com/setup_18.x | bash -
yum install -y nodejs

# å®‰è£…PM2å’Œserve
npm install -g pm2 serve

# å¯åŠ¨MongoDB
docker run -d --name mongodb -p 27017:27017 --restart=always mongo:latest || docker start mongodb

# åˆ›å»ºç›®å½•
mkdir -p /opt/wladmin/{frontend,backend,logs}

# é…ç½®é˜²ç«å¢™
firewall-cmd --permanent --add-port=3004/tcp
firewall-cmd --permanent --add-port=3002/tcp
firewall-cmd --reload

echo "âœ… ç¯å¢ƒé…ç½®å®Œæˆ"
```

---

## ğŸ“¤ ç¬¬ä¸‰æ­¥ï¼šä¸Šä¼ æ–‡ä»¶ï¼ˆåœ¨æœ¬åœ°æ–°ç»ˆç«¯æ‰§è¡Œï¼‰

**æ‰“å¼€æ–°çš„ç»ˆç«¯çª—å£ï¼Œæ‰§è¡Œï¼š**

```bash
cd /Users/liudong/Desktop/myGitProgect/wladmin

# ä¸Šä¼ å‰ç«¯ï¼ˆæ¯æ¬¡è¾“å…¥å¯†ç : ryg@893012ï¼‰
scp -r dist/* root@182.92.59.70:/opt/wladmin/frontend/

# ä¸Šä¼ åç«¯ï¼ˆè¾“å…¥å¯†ç : ryg@893012ï¼‰
scp -r server/* root@182.92.59.70:/opt/wladmin/backend/

# ä¸Šä¼ PM2é…ç½®ï¼ˆè¾“å…¥å¯†ç : ryg@893012ï¼‰
scp deploy/ecosystem.config.js root@182.92.59.70:/opt/wladmin/
```

---

## ğŸ¯ ç¬¬å››æ­¥ï¼šåœ¨æœåŠ¡å™¨ä¸Šå¯åŠ¨æœåŠ¡ï¼ˆå›åˆ°SSHä¼šè¯ï¼‰

```bash
# å®‰è£…åç«¯ä¾èµ–
cd /opt/wladmin/backend
npm install --production

# å¯åŠ¨æœåŠ¡
cd /opt/wladmin
pm2 start ecosystem.config.js

# ä¿å­˜é…ç½®
pm2 save

# æ£€æŸ¥çŠ¶æ€
pm2 list

# æ£€æŸ¥ç«¯å£
netstat -tlnp | grep -E "3004|3002"
```

**åº”è¯¥çœ‹åˆ°ï¼š**
- wladmin-api è¿è¡Œåœ¨ç«¯å£3002
- wladmin-frontend è¿è¡Œåœ¨ç«¯å£3004

---

## ğŸ” ç¬¬äº”æ­¥ï¼šéªŒè¯æœåŠ¡

```bash
# æµ‹è¯•åç«¯
curl http://localhost:3002/api/health

# æµ‹è¯•å‰ç«¯
curl http://localhost:3004 | head -10

# æŸ¥çœ‹æ—¥å¿—
pm2 logs --lines 20
```

---

## ğŸŒ ç¬¬å…­æ­¥ï¼šé…ç½®é˜¿é‡Œäº‘å®‰å…¨ç»„

1. ç™»å½•é˜¿é‡Œäº‘æ§åˆ¶å°
2. **ECS** -> **å®ä¾‹** -> é€‰æ‹©æœåŠ¡å™¨ `iZ2zeanv82adh61pgsha5oZ`
3. **å®‰å…¨ç»„** -> **é…ç½®è§„åˆ™**
4. **æ·»åŠ å®‰å…¨ç»„è§„åˆ™**ï¼š
   - **ç«¯å£èŒƒå›´**: 3004/3004
   - **æˆæƒå¯¹è±¡**: 0.0.0.0/0
   - **æè¿°**: å‰ç«¯ç«¯å£
5. å†æ·»åŠ ä¸€æ¡ï¼š
   - **ç«¯å£èŒƒå›´**: 3002/3002
   - **æˆæƒå¯¹è±¡**: 0.0.0.0/0
   - **æè¿°**: åç«¯APIç«¯å£

---

## âœ… ç¬¬ä¸ƒæ­¥ï¼šè®¿é—®æµ‹è¯•

è®¿é—®ï¼š**http://182.92.59.70:3004**

---

## ğŸ› å¦‚æœè¿˜æ˜¯502é”™è¯¯ï¼Œæ‰§è¡Œä»¥ä¸‹ä¿®å¤ï¼š

**åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œï¼š**

```bash
# 1. æ£€æŸ¥æœåŠ¡çŠ¶æ€
pm2 list

# 2. å¦‚æœæœåŠ¡æœªè¿è¡Œï¼Œé‡æ–°å¯åŠ¨
pm2 delete all
cd /opt/wladmin
pm2 start ecosystem.config.js
pm2 save

# 3. å¦‚æœPM2é…ç½®ä¸å­˜åœ¨ï¼Œæ‰‹åŠ¨å¯åŠ¨
cd /opt/wladmin/backend
PORT=3002 pm2 start index.js --name wladmin-api
cd /opt/wladmin
pm2 start "serve -s frontend -l 3004" --name wladmin-frontend
pm2 save

# 4. æ£€æŸ¥ç«¯å£
netstat -tlnp | grep -E "3004|3002"

# 5. æŸ¥çœ‹é”™è¯¯æ—¥å¿—
pm2 logs
```

---

## ğŸ“ æ£€æŸ¥æ¸…å•

- [ ] Node.jså·²å®‰è£…
- [ ] PM2å’Œserveå·²å®‰è£…
- [ ] MongoDBè¿è¡Œä¸­
- [ ] æ–‡ä»¶å·²ä¸Šä¼ åˆ°æœåŠ¡å™¨
- [ ] åç«¯ä¾èµ–å·²å®‰è£…
- [ ] PM2æœåŠ¡å·²å¯åŠ¨
- [ ] ç«¯å£3004å’Œ3002å·²ç›‘å¬
- [ ] é˜²ç«å¢™å·²å¼€æ”¾ç«¯å£
- [ ] é˜¿é‡Œäº‘å®‰å…¨ç»„å·²é…ç½®

---

## ğŸ‰ å®Œæˆï¼

å¦‚æœæ‰€æœ‰æ­¥éª¤éƒ½å®Œæˆï¼Œè®¿é—®ï¼š**http://182.92.59.70:3004**

é»˜è®¤ç™»å½•ï¼š
- ç”¨æˆ·å: admin
- å¯†ç : 123456
